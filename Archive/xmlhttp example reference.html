<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>

   <script>
      let fileContents = null;
      function readContents(event) {
          console.log("readContents event: " + event + " at " + window.performance.now());
          /* fileContents outputs the following:
          {"gy":2018,"gm":3,"gd":19,"hy":5778,"hm":"Nisan","hd":3,"hebrew":"\u05d2\u05f3 \u05d1\u05bc\u05b0\u05e0\u05b4\u05d9\u05e1\u05b8\u05df \u05ea\u05e9\u05e2\u05f4\u05d7","events":["Parashat Tzav"]}
          I need to be able to use it outside of this function - but anytime I do, it just shows up as undefined :/ */
          fileContents = this.responseText;
          console.log("readContents fileContents: " + fileContents + " at " + window.performance.now());
      }
      let xmlhttp = new XMLHttpRequest();
      xmlhttp.addEventListener("load", readContents, false);
      window.addEventListener("load", (e) => {console.log(e)});
      xmlhttp.open("GET", "https://www.hebcal.com/converter/?cfg=json&gy=2018&gm=3&gd=19&g2h=1", true);
      xmlhttp.send();
      function doWork() {
          if (fileContents === null) {
              window.setTimeout(doWork, 100)
              return
          }
          console.log("Doing work")
          console.log(fileContents)
      }
      doWork()
   </script>
</body>
</html>